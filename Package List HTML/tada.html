<main>
    <div id="banner" style="--banner-accent:#000000;--banner-primary:#000000;--banner-secondary:#000000;--banner-tertiary:#565565;--banner-background:#eff0f3">
     <div class="package-icon" role="img">
     </div>
     <div>
      <div class="title">
       <h1 class="name">
        tada
       </h1>
       <span class="version">
        0.1.0
       </span>
      </div>
      <p class="description">
       Easy, composable tabular data manipulation
      </p>
     </div>
    </div>
    <div class="inner-grid">
     <section id="readme">
      <p>
       TaDa provides a set of simple but powerful operations on rows of data. A full manual is available online:
       <a href="https://github.com/ntjess/typst-tada/blob/v0.1.0/docs/manual.pdf" rel="nofollow ugc" target="_blank">
        https://github.com/ntjess/typst-tada/blob/v0.1.0/docs/manual.pdf
       </a>
      </p>
      <p>
       Key features include:
      </p>
      <ul>
       <li>
        <p>
         <strong>
          Arithmetic expressions
         </strong>
         : Row-wise operations are as simple as string expressions with field names
        </p>
       </li>
       <li>
        <p>
         <strong>
          Aggregation
         </strong>
         : Any function that operates on an array of values can perform row-wise or column-wise aggregation
        </p>
       </li>
       <li>
        <p>
         <strong>
          Data representation
         </strong>
         : Handle displaying currencies, floats, integers, and more with ease and arbitrary customization
        </p>
       </li>
      </ul>
      <p>
       Note: This library is in early development. The API is subject to change especially as typst adds more support for user-defined types.
       <strong>
        Backwards compatibility is not guaranteed!
       </strong>
       Handling of field info, value types, and more may change substantially with more user feedback.
      </p>
      <h2>
       Importing
      </h2>
      <p>
       TaDa can be imported as follows:
      </p>
      <h3>
       From the official packages repository (recommended):
      </h3>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> <span class="typ-str">"@preview/tada:0.1.0"</span>
</code></code></pre>
      <h3>
       From the source code (not recommended)
      </h3>
      <p>
       <strong>
        Option 1:
       </strong>
       You can clone the package directly into your project directory:
      </p>
      <pre><code class="language-bash"># In your project directory
git clone https://github.com/ntjess/typst-tada.git tada
</code></pre>
      <p>
       Then import the functionality with
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> <span class="typ-str">"./tada/lib.typ"</span> 
</code></code></pre>
      <p>
       <strong>
        Option 2:
       </strong>
       If Python is available on your system, use the provided packaging script to install TaDa in typstâs
       <code>
        local
       </code>
       directory:
      </p>
      <pre><code class="language-bash"># Anywhere on your system
  git clone https://github.com/ntjess/typst-tada.git
  cd typst-tada
  
  # Replace $XDG_CACHE_HOME with the appropriate directory based on
  # https://github.com/typst/packages#downloads
  python package.py ./typst.toml "$XDG_CACHE_HOME/typst/packages" \
    --namespace local
  
</code></pre>
      <p>
       Now, TaDa is available under the local namespace:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> <span class="typ-str">"@local/tada:0.1.0"</span>
</code></code></pre>
      <h2>
       Creation
      </h2>
      <p>
       TaDa provides three main ways to construct tables â from columns, rows, or records.
      </p>
      <ul>
       <li>
        <p>
         <strong>
          Columns
         </strong>
         are a dictionary of field names to column values. Alternatively, a 2D array of columns can be passed to
         <code>
          from-columns
         </code>
         , where
         <code>
          values.at(0)
         </code>
         is a column (belongs to one field).
        </p>
       </li>
       <li>
        <p>
         <strong>
          Records
         </strong>
         are a 1D array of dictionaries where each dictionary is a row.
        </p>
       </li>
       <li>
        <p>
         <strong>
          Rows
         </strong>
         are a 2D array where
         <code>
          values.at(0)
         </code>
         is a row (has one value for each field). Note that if
         <code>
          rows
         </code>
         are given without field names, they default to (0, 1, â¦$n$).
        </p>
       </li>
      </ul>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> column-data <span class="typ-op">=</span> <span class="typ-punct">(</span>
  name<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"Bread"</span><span class="typ-punct">,</span> <span class="typ-str">"Milk"</span><span class="typ-punct">,</span> <span class="typ-str">"Eggs"</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  price<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-num">1.25</span><span class="typ-punct">,</span> <span class="typ-num">2.50</span><span class="typ-punct">,</span> <span class="typ-num">1.50</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  quantity<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-num">2</span><span class="typ-punct">,</span> <span class="typ-num">1</span><span class="typ-punct">,</span> <span class="typ-num">3</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> record-data <span class="typ-op">=</span> <span class="typ-punct">(</span>
  <span class="typ-punct">(</span>name<span class="typ-punct">:</span> <span class="typ-str">"Bread"</span><span class="typ-punct">,</span> price<span class="typ-punct">:</span> <span class="typ-num">1.25</span><span class="typ-punct">,</span> quantity<span class="typ-punct">:</span> <span class="typ-num">2</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">(</span>name<span class="typ-punct">:</span> <span class="typ-str">"Milk"</span><span class="typ-punct">,</span> price<span class="typ-punct">:</span> <span class="typ-num">2.50</span><span class="typ-punct">,</span> quantity<span class="typ-punct">:</span> <span class="typ-num">1</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">(</span>name<span class="typ-punct">:</span> <span class="typ-str">"Eggs"</span><span class="typ-punct">,</span> price<span class="typ-punct">:</span> <span class="typ-num">1.50</span><span class="typ-punct">,</span> quantity<span class="typ-punct">:</span> <span class="typ-num">3</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> row-data <span class="typ-op">=</span> <span class="typ-punct">(</span>
  <span class="typ-punct">(</span><span class="typ-str">"Bread"</span><span class="typ-punct">,</span> <span class="typ-num">1.25</span><span class="typ-punct">,</span> <span class="typ-num">2</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">(</span><span class="typ-str">"Milk"</span><span class="typ-punct">,</span> <span class="typ-num">2.50</span><span class="typ-punct">,</span> <span class="typ-num">1</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">(</span><span class="typ-str">"Eggs"</span><span class="typ-punct">,</span> <span class="typ-num">1.50</span><span class="typ-punct">,</span> <span class="typ-num">3</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>

<span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> TableData
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span>data<span class="typ-punct">:</span> column-data<span class="typ-punct">)</span>
<span class="typ-comment">// Equivalent to:</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td2 <span class="typ-op">=</span> tada<span class="typ-punct">.</span><span class="typ-func">from-records</span><span class="typ-punct">(</span>record-data<span class="typ-punct">)</span>
<span class="typ-comment">// _Not_ equivalent to (since field names are unknown):</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td3 <span class="typ-op">=</span> tada<span class="typ-punct">.</span><span class="typ-func">from-rows</span><span class="typ-punct">(</span>row-data<span class="typ-punct">)</span>

<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td2<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td3<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 1" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-01.png"/>
      </p>
      <h2>
       Title formatting
      </h2>
      <p>
       You can pass any
       <code>
        content
       </code>
       as a fieldâs
       <code>
        title
       </code>
       .
       <strong>
        Note
       </strong>
       : if you pass a string, it will be evaluated as markup.
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> <span class="typ-func">fmt</span><span class="typ-punct">(</span>it<span class="typ-punct">)</span> <span class="typ-op">=</span> <span class="typ-punct">{</span>
  <span class="typ-func">heading</span><span class="typ-punct">(</span>outlined<span class="typ-punct">:</span> <span class="typ-key">false</span><span class="typ-punct">,</span>
    <span class="typ-func">upper</span><span class="typ-punct">(</span>it<span class="typ-punct">.</span><span class="typ-func">at</span><span class="typ-punct">(</span><span class="typ-num">0</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
    <span class="typ-op">+</span> it<span class="typ-punct">.</span><span class="typ-func">slice</span><span class="typ-punct">(</span><span class="typ-num">1</span><span class="typ-punct">)</span><span class="typ-punct">.</span><span class="typ-func">replace</span><span class="typ-punct">(</span><span class="typ-str">"_"</span><span class="typ-punct">,</span> <span class="typ-str">" "</span><span class="typ-punct">)</span>
  <span class="typ-punct">)</span>
<span class="typ-punct">}</span>

<span class="typ-key">#</span><span class="typ-key">let</span> titles <span class="typ-op">=</span> <span class="typ-punct">(</span>
  <span class="typ-comment">// As a function</span>
  name<span class="typ-punct">:</span> <span class="typ-punct">(</span>title<span class="typ-punct">:</span> fmt<span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-comment">// As a string</span>
  quantity<span class="typ-punct">:</span> <span class="typ-punct">(</span>title<span class="typ-punct">:</span> <span class="typ-func">fmt</span><span class="typ-punct">(</span><span class="typ-str">"Qty"</span><span class="typ-punct">)</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span><span class="typ-op">..</span>td<span class="typ-punct">,</span> field-info<span class="typ-punct">:</span> titles<span class="typ-punct">)</span>

<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 2" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-02.png"/>
      </p>
      <h2>
       Adapting default behavior
      </h2>
      <p>
       You can specify defaults for any field not explicitly populated by passing information to
       <code>
        field-defaults
       </code>
       . Observe in the last example that
       <code>
        price
       </code>
       was not given a title. We can indicate it should be formatted the same as
       <code>
        name
       </code>
       by passing
       <code>
        title: fmt
       </code>
       to
       <code>
        field-defaults
       </code>
       .
       <strong>
        Note
       </strong>
       that any field that is explicitly given a value will not be affected by
       <code>
        field-defaults
       </code>
       (i.e.,
       <code>
        quantity
       </code>
       will retain its string title âQtyâ)
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> defaults <span class="typ-op">=</span> <span class="typ-punct">(</span>title<span class="typ-punct">:</span> fmt<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span><span class="typ-op">..</span>td<span class="typ-punct">,</span> field-defaults<span class="typ-punct">:</span> defaults<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 3" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-03.png"/>
      </p>
      <h2>
       Using
       <code>
        __index
       </code>
      </h2>
      <p>
       TaDa will automatically add an
       <code>
        __index
       </code>
       field to each row that is hidden by default. If you want it displayed, update its information to set
       <code>
        hide: false
       </code>
       :
      </p>
      <pre><code class="language-typst"><code><span class="typ-comment">// Use the helper function `update-fields` to update multiple fields</span>
<span class="typ-comment">// and/or attributes</span>
<span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> update-fields
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">update-fields</span><span class="typ-punct">(</span>
  td<span class="typ-punct">,</span> __index<span class="typ-punct">:</span> <span class="typ-punct">(</span>hide<span class="typ-punct">:</span> <span class="typ-key">false</span><span class="typ-punct">,</span> title<span class="typ-punct">:</span> <span class="typ-str">"\#"</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
<span class="typ-comment">// You can also insert attributes directly:</span>
<span class="typ-comment">// #td.field-info.__index.insert("hide", false)</span>
<span class="typ-comment">// etc.</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 4" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-04.png"/>
      </p>
      <h2>
       Value formatting
      </h2>
      <h3>
       <code>
        type
       </code>
      </h3>
      <p>
       Type information can have attached metadata that specifies alignment, display formats, and more. Available types and their metadata are:
      </p>
      <ul>
       <li>
        <p>
         <strong>
          string
         </strong>
         : (default-value: "", align: left)
        </p>
       </li>
       <li>
        <p>
         <strong>
          content
         </strong>
         : (display: , align: left)
        </p>
       </li>
       <li>
        <p>
         <strong>
          float
         </strong>
         : (align: right)
        </p>
       </li>
       <li>
        <p>
         <strong>
          integer
         </strong>
         : (align: right)
        </p>
       </li>
       <li>
        <p>
         <strong>
          percent
         </strong>
         : (display: , align: right)
        </p>
       </li>
       <li>
        <p>
         <strong>
          index
         </strong>
         : (align: right)
        </p>
       </li>
      </ul>
      <p>
       While adding your own default types is not yet supported, you can simply defined a dictionary of specifications and pass its keys to the field
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> currency-info <span class="typ-op">=</span> <span class="typ-punct">(</span>
  display<span class="typ-punct">:</span> tada<span class="typ-punct">.</span>display<span class="typ-punct">.</span>format-usd<span class="typ-punct">,</span> align<span class="typ-punct">:</span> right
<span class="typ-punct">)</span>
<span class="typ-pol">#</span><span class="typ-pol">td</span><span class="typ-punct">.</span><span class="typ-pol">field-info</span><span class="typ-punct">.</span><span class="typ-func">insert</span><span class="typ-punct">(</span><span class="typ-str">"price"</span><span class="typ-punct">,</span> <span class="typ-punct">(</span>type<span class="typ-punct">:</span> <span class="typ-str">"currency"</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span><span class="typ-op">..</span>td<span class="typ-punct">,</span> type-info<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"currency"</span><span class="typ-punct">:</span> currency-info<span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 5" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-05.png"/>
      </p>
      <h2>
       Transposing
      </h2>
      <p>
       <code>
        transpose
       </code>
       is supported, but keep in mind if columns have different types, an error will be a frequent result. To avoid the error, explicitly pass
       <code>
        ignore-types: true
       </code>
       . You can choose whether to keep field names as an additional column by passing a string to
       <code>
        fields-name
       </code>
       that is evaluated as markup:
      </p>
      <pre><code class="language-typst"><code><span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>
  tada<span class="typ-punct">.</span><span class="typ-func">transpose</span><span class="typ-punct">(</span>
    td<span class="typ-punct">,</span> ignore-types<span class="typ-punct">:</span> <span class="typ-key">true</span><span class="typ-punct">,</span> fields-name<span class="typ-punct">:</span> <span class="typ-str">""</span>
  <span class="typ-punct">)</span>
<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 6" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-06.png"/>
      </p>
      <h3>
       <code>
        display
       </code>
      </h3>
      <p>
       If your type is not available or you want to customize its display, pass a
       <code>
        display
       </code>
       function that formats the value, or a string that accesses
       <code>
        value
       </code>
       in its scope:
      </p>
      <pre><code class="language-typst"><code><span class="typ-pol">#</span><span class="typ-pol">td</span><span class="typ-punct">.</span><span class="typ-pol">field-info</span><span class="typ-punct">.</span><span class="typ-func">at</span><span class="typ-punct">(</span><span class="typ-str">"quantity"</span><span class="typ-punct">)</span><span class="typ-punct">.</span><span class="typ-func">insert</span><span class="typ-punct">(</span>
  <span class="typ-str">"display"</span><span class="typ-punct">,</span>
  val <span class="typ-op">=&gt;</span> <span class="typ-punct">(</span><span class="typ-str">"/"</span><span class="typ-punct">,</span> <span class="typ-str">"One"</span><span class="typ-punct">,</span> <span class="typ-str">"Two"</span><span class="typ-punct">,</span> <span class="typ-str">"Three"</span><span class="typ-punct">)</span><span class="typ-punct">.</span><span class="typ-func">at</span><span class="typ-punct">(</span>val<span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>

<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span><span class="typ-op">..</span>td<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 7" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-07.png"/>
      </p>
      <h3>
       <code>
        align
       </code>
       etc.
      </h3>
      <p>
       You can pass
       <code>
        align
       </code>
       and
       <code>
        width
       </code>
       to a given fieldâs metadata to determine how content aligns in the cell and how much horizontal space it takes up. In the future, more
       <code>
        tablex
       </code>
       setup arguments will be accepted.
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> adjusted <span class="typ-op">=</span> <span class="typ-func">update-fields</span><span class="typ-punct">(</span>
  td<span class="typ-punct">,</span> name<span class="typ-punct">:</span> <span class="typ-punct">(</span>align<span class="typ-punct">:</span> center<span class="typ-punct">,</span> width<span class="typ-punct">:</span> <span class="typ-num">1.4in</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>adjusted<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 8" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-08.png"/>
      </p>
      <h2>
       Deeper
       <code>
        tablex
       </code>
       customization
      </h2>
      <p>
       TaDa uses
       <code>
        tablex
       </code>
       to display the table. So any argument that
       <code>
        tablex
       </code>
       accepts can be passed to TableData as well:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> mapper <span class="typ-op">=</span> <span class="typ-punct">(</span>index<span class="typ-punct">,</span> row<span class="typ-punct">)</span> <span class="typ-op">=&gt;</span> <span class="typ-punct">{</span>
  <span class="typ-key">let</span> fill <span class="typ-op">=</span> <span class="typ-key">if</span> index <span class="typ-op">==</span> <span class="typ-num">0</span> <span class="typ-punct">{</span><span class="typ-func">rgb</span><span class="typ-punct">(</span><span class="typ-str">"#8888"</span><span class="typ-punct">)</span><span class="typ-punct">}</span> <span class="typ-key">else</span> <span class="typ-punct">{</span><span class="typ-key">none</span><span class="typ-punct">}</span>
  row<span class="typ-punct">.</span><span class="typ-func">map</span><span class="typ-punct">(</span>cell <span class="typ-op">=&gt;</span> <span class="typ-punct">(</span><span class="typ-op">..</span>cell<span class="typ-punct">,</span> fill<span class="typ-punct">:</span> fill<span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-punct">}</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span>
  <span class="typ-op">..</span>td<span class="typ-punct">,</span>
  tablex-kwargs<span class="typ-punct">:</span> <span class="typ-punct">(</span>
    map-rows<span class="typ-punct">:</span> mapper<span class="typ-punct">,</span> auto-vlines<span class="typ-punct">:</span> <span class="typ-key">false</span>
  <span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 9" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-09.png"/>
      </p>
      <h2>
       Subselection
      </h2>
      <p>
       You can select a subset of fields or rows to display:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> subset
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>
  <span class="typ-func">subset</span><span class="typ-punct">(</span>td<span class="typ-punct">,</span> indexes<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-num">0</span><span class="typ-punct">,</span><span class="typ-num">2</span><span class="typ-punct">)</span><span class="typ-punct">,</span> fields<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"name"</span><span class="typ-punct">,</span> <span class="typ-str">"price"</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 10" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-10.png"/>
      </p>
      <p>
       Note that
       <code>
        indexes
       </code>
       is based on the tableâs
       <code>
        __index
       </code>
       column,
       <em>
        not
       </em>
       itâs positional index within the table:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> td2 <span class="typ-op">=</span> td
<span class="typ-pol">#</span><span class="typ-pol">td2</span><span class="typ-punct">.</span><span class="typ-pol">data</span><span class="typ-punct">.</span><span class="typ-func">insert</span><span class="typ-punct">(</span><span class="typ-str">"__index"</span><span class="typ-punct">,</span> <span class="typ-punct">(</span><span class="typ-num">1</span><span class="typ-punct">,</span> <span class="typ-num">2</span><span class="typ-punct">,</span> <span class="typ-num">2</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>
  <span class="typ-func">subset</span><span class="typ-punct">(</span>td2<span class="typ-punct">,</span> indexes<span class="typ-punct">:</span> <span class="typ-num">2</span><span class="typ-punct">,</span> fields<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"__index"</span><span class="typ-punct">,</span> <span class="typ-str">"name"</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 11" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-11.png"/>
      </p>
      <p>
       Rows can also be selected by whether they fulfill a field condition:
      </p>
      <pre><code class="language-typst"><code><span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>
  tada<span class="typ-punct">.</span><span class="typ-func">filter</span><span class="typ-punct">(</span>td<span class="typ-punct">,</span> expression<span class="typ-punct">:</span> <span class="typ-str">"price &lt; 1.5"</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 12" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-12.png"/>
      </p>
      <h2>
       Concatenation
      </h2>
      <p>
       Concatenating rows and columns are both supported operations, but only in the simple sense of stacking the data. Currently, there is no ability to join on a field or otherwise intelligently merge data.
      </p>
      <ul>
       <li>
        <p>
         <code>
          axis: 0
         </code>
         places new rows below current rows
        </p>
       </li>
       <li>
        <p>
         <code>
          axis: 1
         </code>
         places new columns to the right of current columns
        </p>
       </li>
       <li>
        <p>
         Unless you specify a fill value for missing values, the function will panic if the tables do not match exactly along their concatenation axis.
        </p>
       </li>
       <li>
        <p>
         You cannot stack with
         <code>
          axis: 1
         </code>
         unless every column has a unique field name.
        </p>
       </li>
      </ul>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> stack

<span class="typ-key">#</span><span class="typ-key">let</span> td2 <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span>
  data<span class="typ-punct">:</span> <span class="typ-punct">(</span>
    name<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"Cheese"</span><span class="typ-punct">,</span> <span class="typ-str">"Butter"</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
    price<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-num">2.50</span><span class="typ-punct">,</span> <span class="typ-num">1.75</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">)</span>
<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> td3 <span class="typ-op">=</span> <span class="typ-func">TableData</span><span class="typ-punct">(</span>
  data<span class="typ-punct">:</span> <span class="typ-punct">(</span>
    rating<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-num">4.5</span><span class="typ-punct">,</span> <span class="typ-num">3.5</span><span class="typ-punct">,</span> <span class="typ-num">5.0</span><span class="typ-punct">,</span> <span class="typ-num">4.0</span><span class="typ-punct">,</span> <span class="typ-num">2.5</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">)</span>
<span class="typ-punct">)</span>

<span class="typ-comment">// This would fail without specifying the fill</span>
<span class="typ-comment">// since `quantity` is missing from `td2`</span>
<span class="typ-key">#</span><span class="typ-key">let</span> stack-a <span class="typ-op">=</span> <span class="typ-func">stack</span><span class="typ-punct">(</span>td<span class="typ-punct">,</span> td2<span class="typ-punct">,</span> missing-fill<span class="typ-punct">:</span> <span class="typ-num">0</span><span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> stack-b <span class="typ-op">=</span> <span class="typ-func">stack</span><span class="typ-punct">(</span>stack-a<span class="typ-punct">,</span> td3<span class="typ-punct">,</span> axis<span class="typ-punct">:</span> <span class="typ-num">1</span><span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>stack-b<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 13" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-13.png"/>
      </p>
      <h2>
       Expressions
      </h2>
      <p>
       The easiest way to leverage TaDaâs flexibility is through expressions. They can be strings that treat field names as variables, or functions that take keyword-only arguments.
      </p>
      <ul>
       <li>
        <strong>
         Note
        </strong>
        ! When passing functions, every field is passed as a named argument to the function. So, make sure to capture unused fields with
        <code>
         ..rest
        </code>
        (the name is unimportant) to avoid errors.
       </li>
      </ul>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> <span class="typ-func">make-dict</span><span class="typ-punct">(</span>field<span class="typ-punct">,</span> expression<span class="typ-punct">)</span> <span class="typ-op">=</span> <span class="typ-punct">{</span>
  <span class="typ-key">let</span> out <span class="typ-op">=</span> <span class="typ-punct">(</span><span class="typ-punct">:</span><span class="typ-punct">)</span>
  out<span class="typ-punct">.</span><span class="typ-func">insert</span><span class="typ-punct">(</span>
    field<span class="typ-punct">,</span>
    <span class="typ-punct">(</span>expression<span class="typ-punct">:</span> expression<span class="typ-punct">,</span> type<span class="typ-punct">:</span> <span class="typ-str">"currency"</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">)</span>
  out
<span class="typ-punct">}</span>

<span class="typ-key">#</span><span class="typ-key">let</span> td <span class="typ-op">=</span> <span class="typ-func">update-fields</span><span class="typ-punct">(</span>
  td<span class="typ-punct">,</span> <span class="typ-op">..</span><span class="typ-func">make-dict</span><span class="typ-punct">(</span><span class="typ-str">"total"</span><span class="typ-punct">,</span> <span class="typ-str">"price * quantity"</span> <span class="typ-punct">)</span>
<span class="typ-punct">)</span>

<span class="typ-key">#</span><span class="typ-key">let</span> <span class="typ-func">tax-expr</span><span class="typ-punct">(</span>total<span class="typ-punct">:</span> <span class="typ-key">none</span><span class="typ-punct">,</span> <span class="typ-op">..</span>rest<span class="typ-punct">)</span> <span class="typ-op">=</span> <span class="typ-punct">{</span> total <span class="typ-op">*</span> <span class="typ-num">0.2</span> <span class="typ-punct">}</span>
<span class="typ-key">#</span><span class="typ-key">let</span> taxed <span class="typ-op">=</span> <span class="typ-func">update-fields</span><span class="typ-punct">(</span>
  td<span class="typ-punct">,</span> <span class="typ-op">..</span><span class="typ-func">make-dict</span><span class="typ-punct">(</span><span class="typ-str">"tax"</span><span class="typ-punct">,</span> tax-expr<span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>

<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>
  <span class="typ-func">subset</span><span class="typ-punct">(</span>taxed<span class="typ-punct">,</span> fields<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"name"</span><span class="typ-punct">,</span> <span class="typ-str">"total"</span><span class="typ-punct">,</span> <span class="typ-str">"tax"</span><span class="typ-punct">)</span><span class="typ-punct">)</span>
<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 14" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-14.png"/>
      </p>
      <h2>
       Chaining
      </h2>
      <p>
       It is inconvenient to require several temporary variables as above, or deep function nesting, to perform multiple operations on a table. TaDa provides a
       <code>
        chain
       </code>
       function to make this easier. Furthermore, when you need to compute several fields at once and donât need extra field information, you can use
       <code>
        add-expressions
       </code>
       as a shorthand:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> chain<span class="typ-punct">,</span> add-expressions
<span class="typ-key">#</span><span class="typ-key">let</span> totals <span class="typ-op">=</span> <span class="typ-func">chain</span><span class="typ-punct">(</span>td<span class="typ-punct">,</span>
  add-expressions<span class="typ-punct">.</span><span class="typ-func">with</span><span class="typ-punct">(</span>
    total<span class="typ-punct">:</span> <span class="typ-str">"price * quantity"</span><span class="typ-punct">,</span>
    tax<span class="typ-punct">:</span> <span class="typ-str">"total * 0.2"</span><span class="typ-punct">,</span>
    after-tax<span class="typ-punct">:</span> <span class="typ-str">"total + tax"</span><span class="typ-punct">,</span>
  <span class="typ-punct">)</span><span class="typ-punct">,</span>
  subset<span class="typ-punct">.</span><span class="typ-func">with</span><span class="typ-punct">(</span>
    fields<span class="typ-punct">:</span> <span class="typ-punct">(</span><span class="typ-str">"name"</span><span class="typ-punct">,</span> <span class="typ-str">"total"</span><span class="typ-punct">,</span> <span class="typ-str">"after-tax"</span><span class="typ-punct">)</span>
  <span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-comment">// Add type information</span>
  update-fields<span class="typ-punct">.</span><span class="typ-func">with</span><span class="typ-punct">(</span>
    after-tax<span class="typ-punct">:</span> <span class="typ-punct">(</span>type<span class="typ-punct">:</span> <span class="typ-str">"currency"</span><span class="typ-punct">,</span> title<span class="typ-punct">:</span> <span class="typ-func">fmt</span><span class="typ-punct">(</span><span class="typ-str">"w/ Tax"</span><span class="typ-punct">)</span><span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-punct">)</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>totals<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 15" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-15.png"/>
      </p>
      <h2>
       Sorting
      </h2>
      <p>
       You can sort by ascending/descending values of any field, or provide your own transformation function to the
       <code>
        key
       </code>
       argument to customize behavior further:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> sort-values
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span><span class="typ-func">sort-values</span><span class="typ-punct">(</span>
  td<span class="typ-punct">,</span> by<span class="typ-punct">:</span> <span class="typ-str">"quantity"</span><span class="typ-punct">,</span> descending<span class="typ-punct">:</span> <span class="typ-key">true</span>
<span class="typ-punct">)</span><span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 16" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-16.png"/>
      </p>
      <h2>
       Aggregation
      </h2>
      <p>
       Column-wise reduction is supported through
       <code>
        agg
       </code>
       , using either functions or string expressions:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">import</span> tada<span class="typ-punct">:</span> agg<span class="typ-punct">,</span> item
<span class="typ-key">#</span><span class="typ-key">let</span> grand-total <span class="typ-op">=</span> <span class="typ-func">chain</span><span class="typ-punct">(</span>
  totals<span class="typ-punct">,</span>
  agg<span class="typ-punct">.</span><span class="typ-func">with</span><span class="typ-punct">(</span>after-tax<span class="typ-punct">:</span> array<span class="typ-punct">.</span>sum<span class="typ-punct">)</span><span class="typ-punct">,</span>
  <span class="typ-comment">// use "item" to extract exactly one element</span>
  item
<span class="typ-punct">)</span>
<span class="typ-comment">// "Output" is a helper function just for these docs.</span>
<span class="typ-comment">// It is not necessary in your code.</span>
<span class="typ-func">#</span><span class="typ-func">output</span><span class="typ-punct">[</span>
  <span class="typ-strong">*Grand total: <span class="typ-pol">#</span><span class="typ-pol">tada</span><span class="typ-punct">.</span><span class="typ-pol">display</span><span class="typ-punct">.</span><span class="typ-func">format-usd</span><span class="typ-punct">(</span>grand-total<span class="typ-punct">)</span>*</span>
<span class="typ-punct">]</span>
</code></code></pre>
      <p>
       <img alt="Example 17" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-17.png"/>
      </p>
      <p>
       It is also easy to aggregate several expressions at once:
      </p>
      <pre><code class="language-typst"><code><span class="typ-key">#</span><span class="typ-key">let</span> agg-exprs <span class="typ-op">=</span> <span class="typ-punct">(</span>
  <span class="typ-str">"# items"</span><span class="typ-punct">:</span> <span class="typ-str">"quantity.sum()"</span><span class="typ-punct">,</span>
  <span class="typ-str">"Longest name"</span><span class="typ-punct">:</span> <span class="typ-str">"[#name.sorted(key: str.len).at(-1)]"</span><span class="typ-punct">,</span>
<span class="typ-punct">)</span>
<span class="typ-key">#</span><span class="typ-key">let</span> agg-td <span class="typ-op">=</span> tada<span class="typ-punct">.</span><span class="typ-func">agg</span><span class="typ-punct">(</span>td<span class="typ-punct">,</span> <span class="typ-op">..</span>agg-exprs<span class="typ-punct">)</span>
<span class="typ-func">#</span><span class="typ-func">to-tablex</span><span class="typ-punct">(</span>agg-td<span class="typ-punct">)</span>
</code></code></pre>
      <p>
       <img alt="Example 18" src="https://raw.githubusercontent.com/ntjess/typst-tada/v0.1.0/assets/example-18.png"/>
      </p>
     </section>
     <aside>
      <section>
       <h3>
        How to add
       </h3>
       <p>
        Copy this into your project and use the import as
        <!-- -->
        <code>
         tada
        </code>
       </p>
       <div class="import-snippet">
        <pre><code><span class="typ-key">#</span><span class="typ-key">import</span> <span class="typ-str">"@preview/tada:0.1.0"</span></code></pre>
        <button class="copy" title="Copy to clipboard">
         <img alt="Copy" height="16" src="/assets/icons/16-copy.svg" width="16"/>
        </button>
       </div>
       <p class="muted">
        Check the docs for
        <!-- -->
        <a href="https://typst.app/docs/reference/scripting/#packages">
         more information on how to import packages
        </a>
        .
       </p>
      </section>
      <section id="about">
       <h3>
        About
       </h3>
       <dl>
        <dt>
         Author
         <!-- -->
         :
        </dt>
        <dd>
         Nathan Jessurun
        </dd>
        <dt>
         License:
        </dt>
        <dd>
         Unlicense
        </dd>
        <dt>
         Current version:
        </dt>
        <dd>
         0.1.0
        </dd>
        <dt>
         Last updated:
        </dt>
        <dd>
         December 15, 2023
        </dd>
        <dt>
         First released:
        </dt>
        <dd>
         December 15, 2023
        </dd>
        <dt>
         Archive size:
        </dt>
        <dd class="archive-size-value">
         16.2 kB
         <a href="https://packages.typst.org/preview/tada-0.1.0.tar.gz">
          <img alt="Size icon" src="/assets/icons/16-download.svg"/>
         </a>
        </dd>
        <dt>
         Repository:
        </dt>
        <dd>
         <a href="https://github.com/ntjess/typst-tada" rel="noopener noreferrer" target="_blank">
          GitHub
         </a>
        </dd>
       </dl>
      </section>
      <section>
       <h3>
        Where to report issues?
       </h3>
       <p>
        This
        <!-- -->
        package
        <!-- -->
        is a project of
        <!-- -->
        <!-- -->
        Nathan Jessurun
        <!-- -->
        .
        <!-- -->
        <!-- -->
        Report issues on
        <!-- -->
        <a href="https://github.com/ntjess/typst-tada" rel="noopener noreferrer" target="_blank">
         their repository
        </a>
        .
        <!-- -->
        <!-- -->
        You can also try to ask for help with this
        <!-- -->
        package
        <!-- -->
        on the
        <!-- -->
        <a href="https://forum.typst.app" rel="noopener" target="_blank">
         Forum
        </a>
        .
       </p>
       <p>
        Please report this
        <!-- -->
        package
        <!-- -->
        to the Typst team using the
        <!-- -->
        <a href="https://typst.app/contact" rel="noreferrer" target="_blank">
         contact form
        </a>
        <!-- -->
        if you believe it is a safety hazard or infringes upon your rights.
       </p>
      </section>
      <section id="versions">
       <h3>
        Version history
       </h3>
       <table>
        <thead>
         <tr>
          <th align="left">
           Version
          </th>
          <th align="left">
           Release Date
          </th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td align="left">
           0.1.0
          </td>
          <td align="left">
           December 15, 2023
          </td>
         </tr>
        </tbody>
       </table>
      </section>
      <p class="bottom-notice muted">
       Typst GmbH did not create this
       <!-- -->
       package
       <!-- -->
       and cannot guarantee correct functionality of this
       <!-- -->
       package
       <!-- -->
       or compatibility with any version of the Typst compiler or app.
      </p>
     </aside>
    </div>
   </main>