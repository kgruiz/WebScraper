<main>
       <!-- Page table of contents -->
       <div class="sidetoc">
        <nav class="pagetoc">
        </nav>
       </div>
       <h1 id="scripting">
        <a class="header" href="#scripting">
         Scripting
        </a>
       </h1>
       <h2 id="unflatten-arrays">
        <a class="header" href="#unflatten-arrays">
         Unflatten arrays
        </a>
       </h2>
       <div style="margin-bottom: 0.5em">
        <pre style="margin: 0"><code class="language-typ hljs"><span style="color:#586e75;">// author: PgSuper
</span><span style="color:#859900;">#let unflatten</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">arr, n</span><span style="color:#657b83;">) </span><span style="color:#859900;">= </span><span style="color:#657b83;">{
</span><span style="color:var(--fg);">  </span><span style="color:#859900;">let</span><span style="color:var(--fg);"> columns </span><span style="color:#859900;">= range</span><span style="color:#657b83;">(</span><span style="color:#6c71c4;">0</span><span style="color:var(--fg);">, n</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">.</span><span style="color:#859900;">map</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">_ </span><span style="color:#859900;">=&gt; </span><span style="color:#657b83;">())
</span><span style="color:var(--fg);">  </span><span style="color:#859900;">for </span><span style="color:#657b83;">(</span><span style="color:var(--fg);">i, x</span><span style="color:#657b83;">) </span><span style="color:#859900;">in</span><span style="color:var(--fg);"> arr.</span><span style="color:#859900;">enumerate</span><span style="color:#657b83;">() {
</span><span style="color:var(--fg);">    columns.</span><span style="color:#859900;">at</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">calc.</span><span style="color:#859900;">rem</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">i, n</span><span style="color:#657b83;">))</span><span style="color:var(--fg);">.</span><span style="color:#859900;">push</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">x</span><span style="color:#657b83;">)
</span><span style="color:var(--fg);">  </span><span style="color:#657b83;">}
</span><span style="color:var(--fg);">  array.</span><span style="color:#859900;">zip</span><span style="color:#657b83;">(</span><span style="color:#859900;">..</span><span style="color:var(--fg);">columns</span><span style="color:#657b83;">)
</span><span style="color:#657b83;">}
</span><span style="color:var(--fg);">
</span><span style="color:#b58900;">#unflatten</span><span style="color:#657b83;">((</span><span style="color:#6c71c4;">1</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">2</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">3</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">4</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">5</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">6</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">2</span><span style="color:#657b83;">)
</span><span style="color:#b58900;">#unflatten</span><span style="color:#657b83;">((</span><span style="color:#6c71c4;">1</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">2</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">3</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">4</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">5</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">6</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">3</span><span style="color:#657b83;">)</span></code></pre>
        <div style="
                        text-align: center;
                        padding: 0.5em;
                        background: var(--quote-bg);
                        ">
         <img align="middle" alt="Rendered image" src="typst-img/98271a255f0fb10f31ba1d8199ba5a91ebb6f647cdd570220f95e1b88d193ca0-1.svg" style="
                        background: white;
                        max-width: 500pt;
                        width: 100%;
                    "/>
        </div>
       </div>
       <h2 id="create-an-abbreviation">
        <a class="header" href="#create-an-abbreviation">
         Create an abbreviation
        </a>
       </h2>
       <div style="margin-bottom: 0.5em">
        <pre style="margin: 0"><code class="language-typ hljs"><span style="color:#859900;">#let</span><span style="color:var(--fg);"> full</span><span style="color:#859900;">-</span><span style="color:var(--fg);">name </span><span style="color:#859900;">= </span><span style="color:#839496;">"</span><span style="color:#2aa198;">Federal University of Cear√°</span><span style="color:#839496;">"
</span><span style="color:var(--fg);">
</span><span style="color:#859900;">#let</span><span style="color:var(--fg);"> letts </span><span style="color:#859900;">= </span><span style="color:#657b83;">{
</span><span style="color:var(--fg);">  full</span><span style="color:#859900;">-</span><span style="color:var(--fg);">name
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">split</span><span style="color:#657b83;">()
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">map</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">word </span><span style="color:#859900;">=&gt;</span><span style="color:var(--fg);"> word.</span><span style="color:#859900;">at</span><span style="color:#657b83;">(</span><span style="color:#6c71c4;">0</span><span style="color:#657b83;">)) </span><span style="color:#586e75;">// filter only capital letters
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">filter</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">l </span><span style="color:#859900;">=&gt; upper</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">l</span><span style="color:#657b83;">) </span><span style="color:#859900;">==</span><span style="color:var(--fg);"> l</span><span style="color:#657b83;">)
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">join</span><span style="color:#657b83;">()
</span><span style="color:#657b83;">}
</span><span style="color:#859900;">#</span><span style="color:#cb4b16;">letts</span></code></pre>
        <div style="
                        text-align: center;
                        padding: 0.5em;
                        background: var(--quote-bg);
                        ">
         <img align="middle" alt="Rendered image" src="typst-img/e95b77243a1305a47517cb128577d1c7633d858561de0ef797ff551f35be40de-1.svg" style="
                        background: white;
                        max-width: 500pt;
                        width: 100%;
                    "/>
        </div>
       </div>
       <h2 id="split-the-string-retrieving-separators">
        <a class="header" href="#split-the-string-retrieving-separators">
         Split the string retrieving separators
        </a>
       </h2>
       <div style="margin-bottom: 0.5em">
        <pre style="margin: 0"><code class="language-typ hljs"><span style="color:#859900;">#</span><span style="color:#839496;">"</span><span style="color:#2aa198;">,this, is a a a a; a. test? string!</span><span style="color:#839496;">"</span><span style="color:var(--fg);">.</span><span style="color:#859900;">matches</span><span style="color:#657b83;">(</span><span style="color:#859900;">regex</span><span style="color:#657b83;">(</span><span style="color:#839496;">"</span><span style="color:#2aa198;">(\b[\P{Punct}\s]+\b|\p{Punct})</span><span style="color:#839496;">"</span><span style="color:#657b83;">))</span><span style="color:var(--fg);">.</span><span style="color:#859900;">map</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">x </span><span style="color:#859900;">=&gt;</span><span style="color:var(--fg);"> x.captures</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">.</span><span style="color:#859900;">join</span><span style="color:#657b83;">()</span></code></pre>
        <div style="
                        text-align: center;
                        padding: 0.5em;
                        background: var(--quote-bg);
                        ">
         <img align="middle" alt="Rendered image" src="typst-img/c5d183e45097449e4f52b07f82185847092ad28bcad3b9474093d341c4b07c4a-1.svg" style="
                        background: white;
                        max-width: 500pt;
                        width: 100%;
                    "/>
        </div>
       </div>
       <h2 id="create-selector-matching-any-values-in-an-array">
        <a class="header" href="#create-selector-matching-any-values-in-an-array">
         Create selector matching any values in an array
        </a>
       </h2>
       <p>
        This snippet creates a selector (that is then used in a show rule) that
matches any of the values inside the array. Here, it is used to highlight
a few raw lines, but it can be easily adapted to any kind of selector.
       </p>
       <div style="margin-bottom: 0.5em">
        <pre style="margin: 0"><code class="language-typ hljs"><span style="color:#586e75;">// author: Blokyk
</span><span style="color:#859900;">#let</span><span style="color:var(--fg);"> lines </span><span style="color:#859900;">= </span><span style="color:#657b83;">(</span><span style="color:#6c71c4;">2</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">3</span><span style="color:var(--fg);">, </span><span style="color:#6c71c4;">5</span><span style="color:#657b83;">)
</span><span style="color:#859900;">#let</span><span style="color:var(--fg);"> lines</span><span style="color:#859900;">-</span><span style="color:var(--fg);">selectors </span><span style="color:#859900;">=</span><span style="color:var(--fg);"> lines.</span><span style="color:#859900;">map</span><span style="color:#657b83;">(</span><span style="color:var(--fg);">lineno </span><span style="color:#859900;">=&gt;</span><span style="color:var(--fg);"> raw.line.</span><span style="color:#859900;">where</span><span style="color:#657b83;">(</span><span style="color:#268bd2;">number</span><span style="color:var(--fg);">: lineno</span><span style="color:#657b83;">))
</span><span style="color:#859900;">#let</span><span style="color:var(--fg);"> lines</span><span style="color:#859900;">-</span><span style="color:var(--fg);">combined</span><span style="color:#859900;">-</span><span style="color:var(--fg);">selector </span><span style="color:#859900;">=</span><span style="color:var(--fg);"> lines</span><span style="color:#859900;">-</span><span style="color:var(--fg);">selectors.</span><span style="color:#859900;">fold</span><span style="color:#657b83;">(
</span><span style="color:var(--fg);">  </span><span style="color:#586e75;">// start with the first selector by default
</span><span style="color:var(--fg);">  </span><span style="color:#586e75;">// you can also use a selector that wouldn't ever match anything, if possible
</span><span style="color:var(--fg);">  lines</span><span style="color:#859900;">-</span><span style="color:var(--fg);">selectors.</span><span style="color:#859900;">at</span><span style="color:#657b83;">(</span><span style="color:#6c71c4;">0</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">,
</span><span style="color:var(--fg);">  selector.</span><span style="color:#859900;">or </span><span style="color:#586e75;">// create an OR of all selectors (alternatively: (acc, sel) =&gt; acc.or(sel))
</span><span style="color:#657b83;">)
</span><span style="color:var(--fg);">
</span><span style="color:#859900;">#show</span><span style="color:var(--fg);"> lines</span><span style="color:#859900;">-</span><span style="color:var(--fg);">combined</span><span style="color:#859900;">-</span><span style="color:var(--fg);">selector: highlight
</span><span style="color:var(--fg);">
</span><span style="color:var(--fg);">```</span><span style="color:#cb4b16;">py
</span><span style="color:#859900;">def </span><span style="color:#b58900;">foo</span><span style="color:#657b83;">(</span><span style="color:#268bd2;">x</span><span style="color:var(--fg);">, </span><span style="color:#268bd2;">y</span><span style="color:#657b83;">):
</span><span style="color:var(--fg);">  </span><span style="color:#859900;">if </span><span style="color:var(--fg);">x </span><span style="color:#657b83;">== </span><span style="color:var(--fg);">y</span><span style="color:#657b83;">:
</span><span style="color:var(--fg);">    </span><span style="color:#859900;">return </span><span style="color:#b58900;">False
</span><span style="color:var(--fg);">  z </span><span style="color:#657b83;">= </span><span style="color:var(--fg);">x </span><span style="color:#657b83;">+ </span><span style="color:var(--fg);">y
</span><span style="color:var(--fg);">  </span><span style="color:#859900;">return </span><span style="color:var(--fg);">z </span><span style="color:#657b83;">* </span><span style="color:var(--fg);">x </span><span style="color:#657b83;">- </span><span style="color:var(--fg);">z </span><span style="color:#657b83;">* </span><span style="color:var(--fg);">y </span><span style="color:#657b83;">&gt;= </span><span style="color:var(--fg);">z
</span><span style="color:var(--fg);">```</span></code></pre>
        <div style="
                        text-align: center;
                        padding: 0.5em;
                        background: var(--quote-bg);
                        ">
         <img align="middle" alt="Rendered image" src="typst-img/085d1ae3a0672ba278edcde3ebb229a34a40ab5166d0b6d5b469d838b9262a51-1.svg" style="
                        background: white;
                        max-width: 500pt;
                        width: 100%;
                    "/>
        </div>
       </div>
       <h2 id="synthesize-show-or-show-set-rules-from-dictionnary">
        <a class="header" href="#synthesize-show-or-show-set-rules-from-dictionnary">
         Synthesize show (or show-set) rules from dictionnary
        </a>
       </h2>
       <p>
        This snippet applies a show-set rule to any element inside a dictionary,
by using the key as the selector and the value as the parameter to set.
In this example, it's used to give custom supplements to custom figure
kinds, based on a dictionnary of correspondances.
       </p>
       <div style="margin-bottom: 0.5em">
        <pre style="margin: 0"><code class="language-typ hljs"><span style="color:#586e75;">// author: laurmaedje
</span><span style="color:#859900;">#let</span><span style="color:var(--fg);"> kind_supp_dict </span><span style="color:#859900;">= </span><span style="color:#657b83;">(
</span><span style="color:var(--fg);">  algo: </span><span style="color:#839496;">"</span><span style="color:#2aa198;">Pseudo-code</span><span style="color:#839496;">"</span><span style="color:var(--fg);">,
</span><span style="color:var(--fg);">  ex: </span><span style="color:#839496;">"</span><span style="color:#2aa198;">Example</span><span style="color:#839496;">"</span><span style="color:var(--fg);">,
</span><span style="color:var(--fg);">  prob: </span><span style="color:#839496;">"</span><span style="color:#2aa198;">Problem</span><span style="color:#839496;">"</span><span style="color:var(--fg);">,
</span><span style="color:#657b83;">)
</span><span style="color:var(--fg);">
</span><span style="color:#586e75;">// apply this rule to the whole (rest of the) document
</span><span style="color:#859900;">#show</span><span style="color:var(--fg);">: it </span><span style="color:#859900;">=&gt; </span><span style="color:#657b83;">{
</span><span style="color:var(--fg);">  kind_supp_dict
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">pairs</span><span style="color:#657b83;">() </span><span style="color:#586e75;">// get an array of key-value pairs
</span><span style="color:var(--fg);">    .</span><span style="color:#859900;">fold</span><span style="color:#657b83;">( </span><span style="color:#586e75;">// we're going to stack show-set rules before the document
</span><span style="color:var(--fg);">      it, </span><span style="color:#586e75;">// start with the default document
</span><span style="color:var(--fg);">      </span><span style="color:#657b83;">(</span><span style="color:var(--fg);">acc, </span><span style="color:#657b83;">(</span><span style="color:var(--fg);">kind, supp</span><span style="color:#657b83;">)) </span><span style="color:#859900;">=&gt; </span><span style="color:#657b83;">{
</span><span style="color:var(--fg);">        </span><span style="color:#586e75;">// add the curent kind-supp combination on top of the rest
</span><span style="color:var(--fg);">        </span><span style="color:#859900;">show</span><span style="color:var(--fg);"> figure.</span><span style="color:#859900;">where</span><span style="color:#657b83;">(</span><span style="color:#268bd2;">kind</span><span style="color:var(--fg);">: kind</span><span style="color:#657b83;">)</span><span style="color:var(--fg);">: </span><span style="color:#859900;">set figure</span><span style="color:#657b83;">(</span><span style="color:#268bd2;">supplement</span><span style="color:var(--fg);">: supp</span><span style="color:#657b83;">)
</span><span style="color:var(--fg);">        acc
</span><span style="color:var(--fg);">      </span><span style="color:#657b83;">}
</span><span style="color:var(--fg);">    </span><span style="color:#657b83;">)
</span><span style="color:#657b83;">}
</span><span style="color:#b58900;">#figure</span><span style="color:#657b83;">(
</span><span style="color:var(--fg);">    </span><span style="color:#268bd2;">kind</span><span style="color:var(--fg);">: </span><span style="color:#839496;">"</span><span style="color:#2aa198;">algo</span><span style="color:#839496;">"</span><span style="color:var(--fg);">,
</span><span style="color:var(--fg);">    </span><span style="color:#268bd2;">caption</span><span style="color:var(--fg);">: </span><span style="color:#657b83;">[</span><span style="color:var(--fg);">My code</span><span style="color:#657b83;">]</span><span style="color:var(--fg);">,
</span><span style="color:var(--fg);">    ```Algorithm there```
</span><span style="color:#657b83;">)</span></code></pre>
        <div style="
                        text-align: center;
                        padding: 0.5em;
                        background: var(--quote-bg);
                        ">
         <img align="middle" alt="Rendered image" src="typst-img/9de9b5f4bb801735b13ffafe54d35ebcfc78f1df78a34a8ab90f8a6c350b986e-1.svg" style="
                        background: white;
                        max-width: 500pt;
                        width: 100%;
                    "/>
        </div>
       </div>
       <p>
        Additonnaly, as this is applied at the position where you
write it, these show-set rules will appear as if they were added in
the same place where you wrote this rule. This means that you can
override them later, just like any other show-set rules.
       </p>
      </main>